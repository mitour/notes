# MS-SQL 資料庫索引 & 關聯式資料庫

###### tags: `程式筆記` `web111a` `MS-SQL`

* **老師：許志強**
* 時間：2022/3/31

## 上次未講完：Import Data

* 以[郵遞區號 3+2](https://www.post.gov.tw/post/internet/Download/index.jsp?ID=2292)為例
* 先用 excel 做資料整理
  * copy + paste
    * 資料表不用 SELECT id
    * 不用`id`欄
  * BULK INSERT(CSV)
    * 留意`id`欄位也需要

## 肺腑之言

### 想當soho?

* domainKnowHow
  * 該領域的所有專業知識
  * 例如：會計系統需要懂稅務知識等等。
* SA/SD

### 鋪好退休之路

* 年輕人只有肝
  * 趨勢：ERP
* 斜槓
* 客座講師為例
  * $600/hr，最多 80hrs/month，粗略地說是月休四天月薪四萬
  * 責任少，不用招生又場地、設備都有了
  * 教到老
  * 可以接不只一個場
* 能力不夠要會濠洨

## 資料表索引(index)

* 目的是加速查詢速度

![index](https://i.imgur.com/DxGnOP0.png)

### 叢集索引(Clustered Index)

* 叢集索引將資料表或檢視中的資料列**依其索引鍵值排序與儲存**
* 一個資料表只能有一個叢集索引
* 如果資料表沒有任何叢集索引，它的資料列就儲存在未排序的結構中，這個結構稱為堆積。

### 非叢集索引(NonClustered Index)

* 速度比叢集索引慢
* 哪一個欄位容易被作為查詢條件，例如：
  * :heavy_check_mark: 編號
  * :heavy_check_mark: 名稱
* 順序，以上例
  * 編號不會重複沒有必要放優先
  * 故先比對名稱如果重複，再比對編號

> 指不管資料在原本資料表中的排序，而在索引表中自己依照索引值建立排列。與叢集索引的差別是，叢集索引的排列順序就是實際上資料的排列順序，而非叢集索引的排列順序不會/無法影響到實際資料的排列順序。也因此，一個資料表中可以包含很多非叢集索引。
> [FROM Rails 效能優化](https://medium.com/@jinghua.shih/rails-%E7%B6%B2%E7%AB%99%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96-%E4%BA%8C-%E8%B3%87%E6%96%99%E5%BA%AB%E7%B4%A2%E5%BC%95-database-index-bd89fa3757a)

## 關聯式資料管理系統(RDBMS)

* 強調資料的關聯性
* Foreign key

### 誰關聯？（建議作法）

* 與主檔關聯用編號(NO.)
  * 客戶檔[客戶編號]->訂單[訂單編號]
  * 如果客戶被誤刪資料，`id` 有可能會變
* 與表單關聯用`id`
  * 訂單主檔[`id`]->訂單明細檔[訂單編號]
  * 因為訂單編號可能不是唯一，例如：分公司共用系統

### 建立關聯

* 用交易檔去關聯主檔，例如：[訂單檔]->[客戶檔]
